{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["// export default function fetchImages(searchQuery) {\n//   const URL_NAME = 'https://pixabay.com/api/';\n//   const KEY = '42469409-3f592d4c2a8b117d2f80b97d4';\n//   const LINK = `${URL_NAME}?key=${KEY}&q=${searchQuery}&image_type=photo&orientation=horizontal&safesearch=true`;\n\n//   return fetch(LINK).then(response => {\n//     if (!response.ok) {\n//       throw new Error(response.status);\n//     }\n//     return response.json();\n//   });\n// }\nimport axios from 'axios';\n\nexport default async function fetchImages(searchQuery, amountPage, perPage) {\n  const KEY = '42469409-3f592d4c2a8b117d2f80b97d4';\n  // формуємо параметри запиту\n  const params = new URLSearchParams({\n    key: KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: amountPage,\n    per_page: perPage,\n  });\n\n  // отримаємо результат запиту\n  const response = await axios.get(`https://pixabay.com/api/?${params}`);\n\n  // повертаємо данні запиту\n  return response.data;\n}\n","export default function createCard(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                    <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"/>\n                </a>\n                <div class=\"gallery-sign\">\n                    <div>\n                        <h2 class=\"gallery-title\">Likes</h2>\n                        <p class=\"gallery-text\">${likes}</p>\n                    </div>\n                    <div>\n                        <h2 class=\"gallery-title\">Views</h2>\n                        <p class=\"gallery-text\">${views}</p>\n                    </div>\n                    <div>\n                        <h2 class=\"gallery-title\">Comments</h2>\n                        <p class=\"gallery-text\">${comments}</p>\n                    </div>\n                    <div>\n                        <h2 class=\"gallery-title\">Downloads</h2>\n                        <p class=\"gallery-text\">${downloads}</p>\n                    </div>\n                 </div>   \n                </li>`;\n      }\n    )\n    .join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport fetchImages from './js/pixabay-api';\nimport createCard from './js/render-function';\nimport axios from 'axios';\n\nconst searchForm = document.querySelector('form');\nconst loadBtn = document.querySelector('.load-btn');\nconst spinner = document.querySelector('span');\nconst galleryContainer = document.querySelector('.gallery');\nconst optionsLightBox = {\n  captionsData: 'alt',\n  captionDelay: 250,\n};\nconst optionsIziToastSearch = {\n  message:\n    'Sorry, there are no images matching your search query. Please try again!',\n  messageColor: '',\n  messageSize: '25',\n  backgroundColor: '#EF4040',\n  balloon: true,\n  theme: 'light',\n  close: true,\n  closeOnEscape: true,\n  closeOnClick: true,\n  overlay: true,\n  overlayClose: true,\n};\nconst optionsIziToastLoadMore = {\n  message: \"We're sorry, but you've reached the end of search results.\",\n  messageColor: '',\n  messageSize: '25',\n  backgroundColor: '#EF4040',\n  balloon: true,\n  theme: 'light',\n  position: 'topRight',\n  close: true,\n  closeOnEscape: true,\n  closeOnClick: true,\n  overlay: true,\n  overlayClose: true,\n  overlayColor: 'rgba(0, 0, 0, 0.3)',\n  transitionIn: 'fadeInUp',\n};\nconst lightBox = new SimpleLightbox('.gallery a', optionsLightBox);\n\nconst perPage = 15;\nlet currentQuery;\nlet currentPage;\n\nsearchForm.addEventListener('submit', onSubmitBtn);\nloadBtn.addEventListener('click', onClickLoadBtn);\n\nhideLoadBtn();\n\nasync function onSubmitBtn(e) {\n  e.preventDefault();\n  // очищаємо контейнер перед новим запитом\n  resetPage();\n  // отримуємо значення з інпут\n  const searchQuery = e.currentTarget.elements.query.value.trim();\n\n  if (searchQuery) {\n    // addLoader();\n    try {\n      // отримуємо об'єкт з картинками\n      const images = await fetchImages(searchQuery, 1, perPage);\n      console.log(images);\n\n      if (images.total === 0) {\n        resetForm();\n        hideLoadBtn();\n        // deleteLoader();\n        return iziToast.error(optionsIziToastSearch);\n      } else if (images.totalHits <= perPage) {\n        addCardMarkup(images.hits);\n        hideLoadBtn();\n        // deleteLoader();\n      } else {\n        // рендеремо картки\n        addCardMarkup(images.hits);\n        visibleLoadBtn();\n        // deleteLoader();\n        currentQuery = searchQuery;\n        currentPage = 1;\n      }\n    } catch (error) {\n      hideLoadBtn();\n      // deleteLoader();\n      iziToast.error(optionsIziToastSearch);\n    }\n  }\n  resetForm();\n}\n\nasync function onClickLoadBtn() {\n  addLoader();\n  hideLoadBtn();\n  try {\n    currentPage += 1;\n    const images = await fetchImages(currentQuery, currentPage, perPage);\n    const totalPage = Math.ceil(images.totalHits / perPage);\n\n    if (currentPage === totalPage) {\n      deleteLoader();\n      return iziToast.error(optionsIziToastLoadMore);\n    }\n    addCardMarkup(images.hits);\n\n    // робимо прокрутку екрана пр натисканні кнопки\n    const cardElement = document.querySelector('.gallery-image');\n    // отримуємо за допомогою метода об'єкт з властивостями елемента та вибираємо висоту\n    const heightCard = cardElement.getBoundingClientRect().height;\n    const heightScroll = 2 * heightCard;\n    window.scrollBy({\n      top: heightScroll,\n      behavior: 'smooth',\n    });\n    deleteLoader();\n    visibleLoadBtn();\n  } catch (error) {\n    deleteLoader();\n    iziToast.error(optionsIziToastLoadMore);\n  }\n}\n\nfunction addCardMarkup(images) {\n  galleryContainer.insertAdjacentHTML('beforeend', createCard(images));\n  deleteLoader();\n  lightBox.refresh();\n}\n\nfunction resetForm() {\n  searchForm.reset();\n}\n\nfunction resetPage() {\n  galleryContainer.innerHTML = '';\n}\n\nfunction hideLoadBtn() {\n  loadBtn.classList.add('is-hidden');\n}\n\nfunction visibleLoadBtn() {\n  loadBtn.classList.remove('is-hidden');\n}\n\nfunction addLoader() {\n  spinner.classList.add('loader');\n}\n\nfunction deleteLoader() {\n  spinner.classList.remove('loader');\n}\n"],"names":["fetchImages","searchQuery","amountPage","perPage","KEY","params","axios","createCard","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","loadBtn","spinner","galleryContainer","optionsLightBox","optionsIziToastSearch","optionsIziToastLoadMore","lightBox","SimpleLightbox","currentQuery","currentPage","onSubmitBtn","onClickLoadBtn","hideLoadBtn","e","resetPage","resetForm","iziToast","addCardMarkup","visibleLoadBtn","addLoader","totalPage","deleteLoader","heightScroll"],"mappings":"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"}